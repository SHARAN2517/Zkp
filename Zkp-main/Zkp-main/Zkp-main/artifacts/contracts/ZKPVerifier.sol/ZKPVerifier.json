{
  "_format": "hh-sol-artifact-1",
  "contractName": "ZKPVerifier",
  "sourceName": "contracts/ZKPVerifier.sol",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_deviceRegistry",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "deviceId",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "bool",
          "name": "success",
          "type": "bool"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        }
      ],
      "name": "AuthenticationAttempt",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "deviceId",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "prover",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "bool",
          "name": "success",
          "type": "bool"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        }
      ],
      "name": "ProofVerified",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "AUTH_WINDOW",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "MAX_AUTH_ATTEMPTS",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "admin",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "name": "authAttemptCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "deviceRegistry",
      "outputs": [
        {
          "internalType": "contract DeviceRegistry",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "deviceId",
          "type": "bytes32"
        }
      ],
      "name": "getAuthStats",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        },
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "integrityLog",
      "outputs": [
        {
          "internalType": "contract IntegrityLog",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "name": "lastAuthTimestamp",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "deviceId",
          "type": "bytes32"
        }
      ],
      "name": "resetAuthAttempts",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_integrityLog",
          "type": "address"
        }
      ],
      "name": "setIntegrityLog",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "deviceId",
          "type": "bytes32"
        },
        {
          "internalType": "uint256[2]",
          "name": "_pA",
          "type": "uint256[2]"
        },
        {
          "internalType": "uint256[2][2]",
          "name": "_pB",
          "type": "uint256[2][2]"
        },
        {
          "internalType": "uint256[2]",
          "name": "_pC",
          "type": "uint256[2]"
        },
        {
          "internalType": "uint256[4]",
          "name": "publicSignals",
          "type": "uint256[4]"
        }
      ],
      "name": "verifyAndAuthenticate",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x608060405234801561001057600080fd5b50604051610a81380380610a8183398101604081905261002f91610062565b60048054336001600160a01b031991821617909155600080549091166001600160a01b0392909216919091179055610092565b60006020828403121561007457600080fd5b81516001600160a01b038116811461008b57600080fd5b9392505050565b6109e0806100a16000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c80638d2c5879116100715780638d2c58791461013d578063a1ecf95d14610150578063b8bdf9b814610170578063cb1518a9146101a0578063cc42425f146101a8578063f851a440146101cb57600080fd5b80630a60eb01146100ae5780630e248d4f146100c3578063243791bb146100d65780634a8bba1b146101095780635efb870a14610112575b600080fd5b6100c16100bc3660046107c6565b6101de565b005b6100c16100d13660046107f6565b610233565b6100f66100e43660046107f6565b60026020526000908152604090205481565b6040519081526020015b60405180910390f35b6100f661012c81565b600054610125906001600160a01b031681565b6040516001600160a01b039091168152602001610100565b600154610125906001600160a01b031681565b6100f661015e3660046107f6565b60036020526000908152604090205481565b61018361017e3660046107f6565b61027b565b604080519384526020840192909252151590820152606001610100565b6100f6600381565b6101bb6101b6366004610831565b6102e5565b6040519015158152602001610100565b600454610125906001600160a01b031681565b6004546001600160a01b031633146102115760405162461bcd60e51b815260040161020890610895565b60405180910390fd5b600180546001600160a01b0319166001600160a01b0392909216919091179055565b6004546001600160a01b0316331461025d5760405162461bcd60e51b815260040161020890610895565b60009081526003602090815260408083208390556002909152812055565b600080600080600380600087815260200190815260200160002054101580156102bf57506000858152600260205260409020546102bb9061012c906108ed565b4211155b600095865260026020908152604080882054600390925290962054959690945092505050565b60008054604051635ec8fe6b60e01b8152600481018890526001600160a01b0390911690635ec8fe6b90602401602060405180830381865afa15801561032f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103539190610900565b6103935760405162461bcd60e51b8152602060048201526011602482015270446576696365206e6f742061637469766560781b6044820152606401610208565b60008681526003602081905260409091205410806103cb57506000868152600260205260409020546103c89061012c906108ed565b42115b6104175760405162461bcd60e51b815260206004820181905260248201527f546f6f206d616e792061757468656e7469636174696f6e20617474656d7074736044820152606401610208565b6000868152600260205260409020546104339061012c906108ed565b42111561044a576000868152600360205260408120555b600086815260036020526040812080549161046483610922565b909155505060008681526002602052604081204290556104868686868661060c565b90506000610494888561068a565b905060008280156104a25750815b90508015610586576000898152600360205260408120556001546001600160a01b0316156105865760006104d7898989610790565b905060008a426040516020016104f7929190918252602082015260400190565b60408051808303601f19018152908290528051602090910120600180546304cf485d60e01b8452600484018f9052602484018390526044840186905260648401919091529092506001600160a01b0316906304cf485d90608401600060405180830381600087803b15801561056b57600080fd5b505af115801561057f573d6000803e3d6000fd5b5050505050505b60408051821515815242602082015233918b917fd70445ae79bfa82bd8c52e90ca89940dff8279c6c39f91265be2f4ae43e4cae2910160405180910390a36040805182151581524260208201528a917f2dd6231b9d429a6c0f85732d2a40bd1b6b76bff557fc888903cfdfc1bdc4d947910160405180910390a298975050505050505050565b60008435158015906106215750602085013515155b801561062d5750833515155b801561063c5750602084013515155b801561064b5750604084013515155b801561065a5750606084013515155b80156106665750823515155b80156106755750602083013515155b80156106815750813515155b95945050505050565b600081356020830135604084013560608501358683146106b157600094505050505061078a565b6106bd61012c4261093b565b8210806106d357506106d042603c6108ed565b82115b156106e557600094505050505061078a565b60008054604051630be54c8f60e41b8152600481018a90526001600160a01b039091169063be54c8f090602401602060405180830381865afa15801561072f573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610753919061094e565b905080851461076a5760009550505050505061078a565b816001146107805760009550505050505061078a565b6001955050505050505b92915050565b60008383836040516020016107a793929190610967565b6040516020818303038152906040528051906020012090509392505050565b6000602082840312156107d857600080fd5b81356001600160a01b03811681146107ef57600080fd5b9392505050565b60006020828403121561080857600080fd5b5035919050565b806040810183101561078a57600080fd5b806080810183101561078a57600080fd5b60008060008060006101a0868803121561084a57600080fd5b8535945061085b876020880161080f565b935061086a8760608801610820565b92506108798760e0880161080f565b9150610889876101208801610820565b90509295509295909350565b60208082526022908201527f4f6e6c792061646d696e2063616e20706572666f726d2074686973206163746960408201526137b760f11b606082015260800190565b634e487b7160e01b600052601160045260246000fd5b8082018082111561078a5761078a6108d7565b60006020828403121561091257600080fd5b815180151581146107ef57600080fd5b600060018201610934576109346108d7565b5060010190565b8181038181111561078a5761078a6108d7565b60006020828403121561096057600080fd5b5051919050565b60006040808684378083018560005b600281101561099357838284379183019190830190600101610976565b505050808460c0850137505061010001939250505056fea264697066735822122054b502b07cb3ebcd3ee1af1ca2ae5b17458a3867e4a25568895f72319d8980a064736f6c63430008130033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100a95760003560e01c80638d2c5879116100715780638d2c58791461013d578063a1ecf95d14610150578063b8bdf9b814610170578063cb1518a9146101a0578063cc42425f146101a8578063f851a440146101cb57600080fd5b80630a60eb01146100ae5780630e248d4f146100c3578063243791bb146100d65780634a8bba1b146101095780635efb870a14610112575b600080fd5b6100c16100bc3660046107c6565b6101de565b005b6100c16100d13660046107f6565b610233565b6100f66100e43660046107f6565b60026020526000908152604090205481565b6040519081526020015b60405180910390f35b6100f661012c81565b600054610125906001600160a01b031681565b6040516001600160a01b039091168152602001610100565b600154610125906001600160a01b031681565b6100f661015e3660046107f6565b60036020526000908152604090205481565b61018361017e3660046107f6565b61027b565b604080519384526020840192909252151590820152606001610100565b6100f6600381565b6101bb6101b6366004610831565b6102e5565b6040519015158152602001610100565b600454610125906001600160a01b031681565b6004546001600160a01b031633146102115760405162461bcd60e51b815260040161020890610895565b60405180910390fd5b600180546001600160a01b0319166001600160a01b0392909216919091179055565b6004546001600160a01b0316331461025d5760405162461bcd60e51b815260040161020890610895565b60009081526003602090815260408083208390556002909152812055565b600080600080600380600087815260200190815260200160002054101580156102bf57506000858152600260205260409020546102bb9061012c906108ed565b4211155b600095865260026020908152604080882054600390925290962054959690945092505050565b60008054604051635ec8fe6b60e01b8152600481018890526001600160a01b0390911690635ec8fe6b90602401602060405180830381865afa15801561032f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103539190610900565b6103935760405162461bcd60e51b8152602060048201526011602482015270446576696365206e6f742061637469766560781b6044820152606401610208565b60008681526003602081905260409091205410806103cb57506000868152600260205260409020546103c89061012c906108ed565b42115b6104175760405162461bcd60e51b815260206004820181905260248201527f546f6f206d616e792061757468656e7469636174696f6e20617474656d7074736044820152606401610208565b6000868152600260205260409020546104339061012c906108ed565b42111561044a576000868152600360205260408120555b600086815260036020526040812080549161046483610922565b909155505060008681526002602052604081204290556104868686868661060c565b90506000610494888561068a565b905060008280156104a25750815b90508015610586576000898152600360205260408120556001546001600160a01b0316156105865760006104d7898989610790565b905060008a426040516020016104f7929190918252602082015260400190565b60408051808303601f19018152908290528051602090910120600180546304cf485d60e01b8452600484018f9052602484018390526044840186905260648401919091529092506001600160a01b0316906304cf485d90608401600060405180830381600087803b15801561056b57600080fd5b505af115801561057f573d6000803e3d6000fd5b5050505050505b60408051821515815242602082015233918b917fd70445ae79bfa82bd8c52e90ca89940dff8279c6c39f91265be2f4ae43e4cae2910160405180910390a36040805182151581524260208201528a917f2dd6231b9d429a6c0f85732d2a40bd1b6b76bff557fc888903cfdfc1bdc4d947910160405180910390a298975050505050505050565b60008435158015906106215750602085013515155b801561062d5750833515155b801561063c5750602084013515155b801561064b5750604084013515155b801561065a5750606084013515155b80156106665750823515155b80156106755750602083013515155b80156106815750813515155b95945050505050565b600081356020830135604084013560608501358683146106b157600094505050505061078a565b6106bd61012c4261093b565b8210806106d357506106d042603c6108ed565b82115b156106e557600094505050505061078a565b60008054604051630be54c8f60e41b8152600481018a90526001600160a01b039091169063be54c8f090602401602060405180830381865afa15801561072f573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610753919061094e565b905080851461076a5760009550505050505061078a565b816001146107805760009550505050505061078a565b6001955050505050505b92915050565b60008383836040516020016107a793929190610967565b6040516020818303038152906040528051906020012090509392505050565b6000602082840312156107d857600080fd5b81356001600160a01b03811681146107ef57600080fd5b9392505050565b60006020828403121561080857600080fd5b5035919050565b806040810183101561078a57600080fd5b806080810183101561078a57600080fd5b60008060008060006101a0868803121561084a57600080fd5b8535945061085b876020880161080f565b935061086a8760608801610820565b92506108798760e0880161080f565b9150610889876101208801610820565b90509295509295909350565b60208082526022908201527f4f6e6c792061646d696e2063616e20706572666f726d2074686973206163746960408201526137b760f11b606082015260800190565b634e487b7160e01b600052601160045260246000fd5b8082018082111561078a5761078a6108d7565b60006020828403121561091257600080fd5b815180151581146107ef57600080fd5b600060018201610934576109346108d7565b5060010190565b8181038181111561078a5761078a6108d7565b60006020828403121561096057600080fd5b5051919050565b60006040808684378083018560005b600281101561099357838284379183019190830190600101610976565b505050808460c0850137505061010001939250505056fea264697066735822122054b502b07cb3ebcd3ee1af1ca2ae5b17458a3867e4a25568895f72319d8980a064736f6c63430008130033",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
